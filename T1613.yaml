attack_technique: T1613
display_name: "Container Resource Discovery"
atomic_tests:
- name: ContainerResourceDiscovery
  auto_generated_guid:
  description: |
    Adversaries may attempt to discover containers and other resources that are available within a containers environment.
  supported_platforms:
  - containers
  dependency_executor_name: sh
  dependencies: 
  - description: Check if docker is installed.
    prereq_command: |
      which docker
    get_prereq_command: |
      if [ "" == "`which docker`" ]; then echo "Docker Not Found"; if [ -n "`which apt-get`" ]; then sudo apt-get -y install docker ; elif [ -n "`which yum`" ]; then sudo yum -y install docker ; fi ; else echo "Docker installed"; fi
  - description: Verify docker service is running.
    prereq_command: |
      sudo systemctl status docker
    get_prereq_command: |
      sudo systemctl start docker
  - description: Verify docker service is running.
    prereq_command: |
      sudo systemctl status docker
    get_prereq_command: |
      sudo systemctl start docker
    executor:
    command: |
    docker build -t t1613 /root/src
    docker run -d -t t1613
    docker ps
    docker logs --tail 10 $(docker ps -l -q --filter ancestor=t1613)
    
    name: bash
    cleanup_command: |
      docker rm $(docker stop $(docker ps -a -q --filter ancestor=t1613))
    name: bash
    elevation_required: false
